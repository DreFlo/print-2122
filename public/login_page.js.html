<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: login_page.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: login_page.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
/**
 * The steps for the process of login are:
 * 1 - checks if the person is logged
 * 2 - decides the interface
 * 3 - build login form or login welcome
 * */

/**
 * Checks if the person is already logged. The input can be wrong or right. To decide it there's the function
 * decisionLogin.
 */
function checkLogin() {
    pyCall("login_check", "decisionLogin");
}

/**
 * Function to update the file logged.
 */
function decisionLogin(data) {
    if (data['Name'] === "NONE") set_logged('false');      //case the login input is wrong
    else set_logged('true');
}

/**
 * Logout from sigarra
 */
function logout() {
    console.log("logout");
    set_logged('false');
    pyCall("logout", "checkLogin");
}

/**
 * Function resposible to read the information in the input and call python to get the information from web
 */
function handleLogin() {
    let login_username = document.getElementById("login-username").value;
    let login_password = document.getElementById("login-password").value;

    addLoadAnimationModal();
    pyCall("login_page", "final_handleLogin", [login_username, login_password]);


}


/**
 * Function executed after handle Login that checks treat Login errors and call checkLogin to show the welcome
 * message or request the input information again
 *
 * @param data - python output in json format
 */
function final_handleLogin(data) {
    removeLoadAnimation();
    if (data['error'] === 'true') {
        set_logged('false');
        document.getElementById('login-username').value = "";
        document.getElementById('login-password').value = "";
        errorMessage();
    } else {
        set_logged('true');
        location.reload();
        checkLogin();
    }

}

function errorMessage() {
    console.log('error');
    document.getElementById("error").innerHTML = "&lt;span> Utilizador ou senha incorreta&lt;/span>";

    setTimeout(function(){
        document.getElementById("error").innerHTML = "";
    }, 5000);

}



module.exports = {logout, handleLogin, final_handleLogin};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="pyshellCaller.html">pyshellCaller</a></li><li><a href="ReadJson.html">ReadJson</a></li></ul><h3>Global</h3><ul><li><a href="global.html#buildTable">buildTable</a></li><li><a href="global.html#checkLogin">checkLogin</a></li><li><a href="global.html#decisionLogin">decisionLogin</a></li><li><a href="global.html#final_handleLogin">final_handleLogin</a></li><li><a href="global.html#final_handleTeacherSched">final_handleTeacherSched</a></li><li><a href="global.html#get_logged">get_logged</a></li><li><a href="global.html#handleLogin">handleLogin</a></li><li><a href="global.html#handleTheacherSched">handleTheacherSched</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#pyCall">pyCall</a></li><li><a href="global.html#set_login_modal">set_login_modal</a></li><li><a href="global.html#set_menu_bar">set_menu_bar</a></li><li><a href="global.html#set_menu_search">set_menu_search</a></li><li><a href="global.html#shell">shell</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Thu Sep 17 2020 17:22:47 GMT+0100 (GMT+01:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
